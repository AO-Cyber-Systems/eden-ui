---
/**
 * WorkshopEmbed - Embeds a Bookemoji component story into documentation
 *
 * Usage:
 * <WorkshopEmbed story="buttons/Button" />
 * <WorkshopEmbed story="forms/Input" height="500px" />
 */
interface Props {
  /** Path to the story (e.g., "buttons/Button", "forms/Input") */
  story: string;
  /** Height of the iframe embed */
  height?: string;
  /** Title for accessibility */
  title?: string;
}

const { story, height = '400px', title } = Astro.props;

// Workshop URL changes based on environment
const workshopBaseUrl = import.meta.env.DEV
  ? 'http://localhost:5173/workshop'  // Dev server
  : '/workshop';                       // Production (served from same domain)

const workshopUrl = `${workshopBaseUrl}/books/stories/${story}`;
const frameTitle = title || `${story} component demo`;
---

<div class="workshop-embed">
  <div class="workshop-header">
    <span class="workshop-label">Live Demo</span>
    <a href={workshopUrl} target="_blank" rel="noopener" class="workshop-link">
      Open in Workshop
      <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
        <polyline points="15 3 21 3 21 9"></polyline>
        <line x1="10" y1="14" x2="21" y2="3"></line>
      </svg>
    </a>
  </div>
  <iframe
    src={workshopUrl}
    style={`height: ${height};`}
    title={frameTitle}
    loading="lazy"
  />
</div>

<style>
  .workshop-embed {
    margin: 1.5rem 0;
    border: 1px solid var(--sl-color-gray-5);
    border-radius: 0.5rem;
    overflow: hidden;
    background: var(--sl-color-bg);
  }

  .workshop-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 1rem;
    background: var(--sl-color-gray-6);
    border-bottom: 1px solid var(--sl-color-gray-5);
    font-size: 0.875rem;
  }

  .workshop-label {
    color: var(--sl-color-gray-2);
    font-weight: 500;
  }

  .workshop-link {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    color: var(--sl-color-accent);
    text-decoration: none;
  }

  .workshop-link:hover {
    text-decoration: underline;
  }

  iframe {
    width: 100%;
    border: none;
    background: var(--sl-color-bg);
  }
</style>
