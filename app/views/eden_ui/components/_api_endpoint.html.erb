<%
  method ||= :get
  path ||= "/"
  description ||= nil
  params ||= []
  response_example ||= nil
  auth_required = local_assigns.fetch(:auth_required, true)
  html_options ||= {}
  content ||= nil

  method_styles = {
    get:    { bg: "bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300", border: "border-l-green-500" },
    post:   { bg: "bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-300", border: "border-l-primary-500" },
    put:    { bg: "bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300", border: "border-l-yellow-500" },
    patch:  { bg: "bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300", border: "border-l-orange-500" },
    delete: { bg: "bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300", border: "border-l-red-500" }
  }

  style = method_styles[method.to_sym] || method_styles[:get]

  classes = [
    "rounded-lg border border-zinc-200 bg-white shadow-sm dark:border-zinc-700 dark:bg-zinc-800 border-l-4",
    style[:border],
    html_options.delete(:class)
  ].compact_blank.join(" ")
%>

<div class="<%= classes %>" <%= tag.attributes(html_options) %>>
  <%# Header %>
  <div class="flex flex-wrap items-center gap-3 p-4">
    <span class="inline-flex items-center rounded-md px-2.5 py-1 text-xs font-bold uppercase <%= style[:bg] %>">
      <%= method.to_s.upcase %>
    </span>
    <code class="text-sm font-semibold font-mono text-zinc-900 dark:text-white"><%= path %></code>
    <% if auth_required %>
      <span class="inline-flex items-center gap-1 rounded-md bg-zinc-100 px-2 py-0.5 text-xs font-medium text-zinc-600 dark:bg-zinc-700 dark:text-zinc-300">
        <svg class="h-3 w-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
          <path fill-rule="evenodd" d="M8 10V7a4 4 0 1 1 8 0v3h1a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h1Zm2-3a2 2 0 1 1 4 0v3h-4V7Zm2 6a1 1 0 0 1 1 1v3a1 1 0 1 1-2 0v-3a1 1 0 0 1 1-1Z" clip-rule="evenodd"/>
        </svg>
        Auth required
      </span>
    <% end %>
  </div>

  <% if description %>
    <div class="border-t border-zinc-200 dark:border-zinc-700 px-4 py-3">
      <p class="text-sm text-zinc-600 dark:text-zinc-400"><%= description %></p>
    </div>
  <% end %>

  <%# Parameters table %>
  <% if params.any? %>
    <div class="border-t border-zinc-200 dark:border-zinc-700 px-4 py-3">
      <h4 class="mb-2 text-xs font-semibold uppercase tracking-wide text-zinc-500 dark:text-zinc-400">Parameters</h4>
      <div class="overflow-x-auto">
        <table class="w-full text-left text-sm">
          <thead class="text-xs uppercase text-zinc-500 dark:text-zinc-400">
            <tr>
              <th class="pb-2 pr-4 font-medium">Name</th>
              <th class="pb-2 pr-4 font-medium">Type</th>
              <th class="pb-2 pr-4 font-medium">Required</th>
              <th class="pb-2 font-medium">Description</th>
            </tr>
          </thead>
          <tbody class="text-zinc-700 dark:text-zinc-300">
            <% params.each do |param| %>
              <tr class="border-t border-zinc-100 dark:border-zinc-700">
                <td class="py-2 pr-4">
                  <code class="text-xs font-mono font-semibold text-zinc-900 dark:text-white"><%= param[:name] %></code>
                </td>
                <td class="py-2 pr-4">
                  <span class="text-xs text-zinc-500 dark:text-zinc-400"><%= param[:type] %></span>
                </td>
                <td class="py-2 pr-4">
                  <% if param[:required] %>
                    <span class="inline-flex items-center rounded-full bg-red-100 px-2 py-0.5 text-xs font-medium text-red-800 dark:bg-red-900 dark:text-red-300">Required</span>
                  <% else %>
                    <span class="inline-flex items-center rounded-full bg-zinc-100 px-2 py-0.5 text-xs font-medium text-zinc-600 dark:bg-zinc-700 dark:text-zinc-400">Optional</span>
                  <% end %>
                </td>
                <td class="py-2 text-xs text-zinc-500 dark:text-zinc-400"><%= param[:description] %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  <% end %>

  <%# Response example %>
  <% if response_example %>
    <div class="border-t border-zinc-200 dark:border-zinc-700 px-4 py-3">
      <h4 class="mb-2 text-xs font-semibold uppercase tracking-wide text-zinc-500 dark:text-zinc-400">Response Example</h4>
      <div class="rounded-lg bg-zinc-900 p-4">
        <pre class="overflow-x-auto text-sm font-mono text-zinc-100"><code><%= response_example %></code></pre>
      </div>
    </div>
  <% end %>

  <%= content %>
</div>
