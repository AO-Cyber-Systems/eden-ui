<%
  sender ||= nil
  subject ||= nil
  preview ||= nil
  time ||= nil
  unread ||= false
  selected ||= false
  starred ||= false
  avatar_src ||= nil
  avatar_initials ||= nil
  html_options ||= {}
  content ||= nil

  row_bg = if unread
    "bg-blue-50 dark:bg-blue-900/10"
  else
    "bg-white dark:bg-gray-800"
  end

  sender_classes = if unread
    "font-semibold text-gray-900 dark:text-white"
  else
    "font-normal text-gray-700 dark:text-gray-400"
  end

  subject_classes = if unread
    "font-semibold text-gray-900 dark:text-white"
  else
    "font-normal text-gray-500 dark:text-gray-400"
  end

  classes = [
    "flex items-center gap-4 px-4 py-3 border-b border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",
    row_bg,
    html_options.delete(:class)
  ].compact_blank.join(" ")
%>

<div class="<%= classes %>" <%= tag.attributes(html_options) %>>
  <%# Checkbox %>
  <div class="shrink-0">
    <input type="checkbox" <%= "checked" if selected %> class="h-4 w-4 rounded-sm border-gray-300 bg-gray-50 focus:ring-2 focus:ring-blue-300 dark:border-gray-600 dark:bg-gray-700 dark:ring-offset-gray-800 dark:focus:ring-blue-600" aria-label="Select message">
  </div>

  <%# Star %>
  <div class="shrink-0">
    <% if starred %>
      <svg class="h-5 w-5 text-yellow-400" fill="currentColor" viewBox="0 0 24 24"><path d="M11.1 4.1c.4-.8 1.5-.8 1.8 0l1.8 4a1 1 0 0 0 .8.6l4.5.4c.9 0 1.2 1.2.5 1.7l-3.3 2.8a1 1 0 0 0-.3 1l1 4.1c.2.9-.7 1.6-1.5 1.1l-3.9-2.3a1 1 0 0 0-1 0L7.6 19.8c-.8.5-1.7-.2-1.5-1.1l1-4.1a1 1 0 0 0-.3-1L3.4 10.8c-.7-.5-.3-1.7.6-1.7l4.4-.4a1 1 0 0 0 .9-.6l1.8-4Z"/></svg>
    <% else %>
      <svg class="h-5 w-5 text-gray-400 hover:text-yellow-400 dark:text-gray-500 dark:hover:text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M11.1 4.1c.4-.8 1.5-.8 1.8 0l1.8 4a1 1 0 0 0 .8.6l4.5.4c.9 0 1.2 1.2.5 1.7l-3.3 2.8a1 1 0 0 0-.3 1l1 4.1c.2.9-.7 1.6-1.5 1.1l-3.9-2.3a1 1 0 0 0-1 0L7.6 19.8c-.8.5-1.7-.2-1.5-1.1l1-4.1a1 1 0 0 0-.3-1L3.4 10.8c-.7-.5-.3-1.7.6-1.7l4.4-.4a1 1 0 0 0 .9-.6l1.8-4Z"/></svg>
    <% end %>
  </div>

  <%# Avatar %>
  <div class="shrink-0">
    <%= eden_avatar(src: avatar_src, initials: avatar_initials, size: :sm, rounded: true, alt: sender || "Sender") %>
  </div>

  <%# Content area %>
  <div class="min-w-0 flex-1">
    <div class="flex items-center gap-2">
      <% if sender %>
        <span class="text-sm truncate <%= sender_classes %>"><%= sender %></span>
      <% end %>
      <% if unread %>
        <span class="inline-block w-2 h-2 rounded-full bg-blue-600 shrink-0"></span>
      <% end %>
    </div>
    <div class="flex items-baseline gap-2">
      <% if subject %>
        <span class="text-sm truncate <%= subject_classes %>"><%= subject %></span>
      <% end %>
      <% if preview %>
        <span class="hidden sm:inline text-sm text-gray-400 dark:text-gray-500 truncate">- <%= preview %></span>
      <% end %>
    </div>
  </div>

  <%# Time %>
  <% if time %>
    <div class="shrink-0 text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap">
      <%= time %>
    </div>
  <% end %>

  <%= content %>
</div>
