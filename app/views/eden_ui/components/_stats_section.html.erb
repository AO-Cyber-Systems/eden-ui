<%
  title ||= nil
  subtitle ||= nil
  stats ||= []
  variant ||= :default
  html_options ||= {}
  content ||= nil

  variant = variant.to_sym

  bg_classes = case variant
  when :colored
    "bg-primary-600 dark:bg-primary-700"
  else
    "bg-white dark:bg-zinc-900"
  end

  text_color = case variant
  when :colored
    "text-white"
  else
    "text-zinc-900 dark:text-white"
  end

  sub_color = case variant
  when :colored
    "text-primary-200"
  else
    "text-zinc-500 dark:text-zinc-400"
  end

  stat_count = [stats.size, 6].min
  col_class = case stat_count
  when 1 then ""
  when 2 then "md:grid-cols-2"
  when 3 then "md:grid-cols-3"
  when 4 then "md:grid-cols-2 lg:grid-cols-4"
  else "md:grid-cols-3 lg:grid-cols-#{stat_count}"
  end

  classes = [bg_classes, html_options.delete(:class)].compact_blank.join(" ")
%>

<section class="<%= classes %>" <%= tag.attributes(html_options) %>>
  <div class="py-8 px-4 mx-auto max-w-screen-xl lg:py-16">
    <% if title || subtitle %>
      <div class="mx-auto max-w-screen-md text-center mb-8 lg:mb-16">
        <% if title %>
          <h2 class="mb-4 text-3xl font-extrabold tracking-tight <%= text_color %> md:text-4xl"><%= title %></h2>
        <% end %>
        <% if subtitle %>
          <p class="font-light <%= sub_color %> sm:text-xl"><%= subtitle %></p>
        <% end %>
      </div>
    <% end %>

    <% if variant == :cards %>
      <div class="grid gap-8 <%= col_class %>">
        <% stats.each do |stat| %>
          <div class="p-6 bg-white rounded-lg shadow border border-zinc-200 dark:bg-zinc-800 dark:border-zinc-700 text-center">
            <p class="text-4xl font-extrabold text-zinc-900 dark:text-white"><%= stat[:value] %></p>
            <p class="mt-2 text-zinc-500 dark:text-zinc-400"><%= stat[:label] %></p>
            <% if stat[:description] %>
              <p class="mt-1 text-sm text-zinc-400 dark:text-zinc-500"><%= stat[:description] %></p>
            <% end %>
          </div>
        <% end %>
      </div>
    <% else %>
      <%# :default and :colored share the same inline layout %>
      <div class="grid gap-8 <%= col_class %> text-center">
        <% stats.each_with_index do |stat, i| %>
          <div class="<%= variant == :default && i > 0 ? 'md:border-l md:border-zinc-200 md:dark:border-zinc-700' : '' %>">
            <p class="text-4xl font-extrabold <%= text_color %>"><%= stat[:value] %></p>
            <p class="mt-2 <%= sub_color %>"><%= stat[:label] %></p>
            <% if stat[:description] %>
              <p class="mt-1 text-sm <%= variant == :colored ? 'text-primary-100' : 'text-zinc-400 dark:text-zinc-500' %>"><%= stat[:description] %></p>
            <% end %>
          </div>
        <% end %>
      </div>
    <% end %>

    <%= content %>
  </div>
</section>
