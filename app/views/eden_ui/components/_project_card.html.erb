<%
  title ||= ""
  description ||= nil
  status ||= :active
  progress ||= 0
  team ||= []
  due_date ||= nil
  html_options ||= {}
  content ||= nil

  status_variant = case status.to_sym
  when :completed then :success
  when :on_hold then :warning
  when :at_risk then :danger
  else :info
  end

  status_label = case status.to_sym
  when :completed then "Completed"
  when :on_hold then "On Hold"
  when :at_risk then "At Risk"
  else "Active"
  end

  progress_variant = case status.to_sym
  when :completed then :success
  when :at_risk then :danger
  when :on_hold then :warning
  else :primary
  end

  classes = [
    "bg-white border border-zinc-200 rounded-lg shadow-sm dark:bg-zinc-800 dark:border-zinc-700 p-5",
    html_options.delete(:class)
  ].compact_blank.join(" ")
%>

<div class="<%= classes %>" <%= tag.attributes(html_options) %>>
  <%# Header: title + status badge %>
  <div class="flex items-start justify-between mb-3">
    <h3 class="text-lg font-semibold text-zinc-900 dark:text-white"><%= title %></h3>
    <%= eden_badge(text: status_label, variant: status_variant, size: :xs, pill: true) %>
  </div>

  <%# Description %>
  <% if description %>
    <p class="text-sm text-zinc-500 dark:text-zinc-400 mb-4"><%= description %></p>
  <% end %>

  <%# Progress bar %>
  <div class="mb-4">
    <div class="flex justify-between mb-1">
      <span class="text-xs font-medium text-zinc-500 dark:text-zinc-400">Progress</span>
      <span class="text-xs font-medium text-zinc-700 dark:text-zinc-300"><%= progress %>%</span>
    </div>
    <%= eden_progress(value: progress, size: :sm, variant: progress_variant) %>
  </div>

  <%# Custom block content %>
  <%= content %>

  <%# Footer: team + due date %>
  <div class="flex items-center justify-between pt-3 border-t border-zinc-200 dark:border-zinc-700">
    <% if team.any? %>
      <div class="flex -space-x-2">
        <% team.first(5).each do |member| %>
          <%= eden_avatar(src: member[:src], initials: member[:initials], alt: member[:name] || "", size: :xs, rounded: true) %>
        <% end %>
        <% if team.size > 5 %>
          <div class="flex items-center justify-center w-6 h-6 text-xs font-medium text-zinc-600 bg-zinc-200 rounded-full ring-2 ring-white dark:bg-zinc-700 dark:text-zinc-300 dark:ring-zinc-800">+<%= team.size - 5 %></div>
        <% end %>
      </div>
    <% else %>
      <div></div>
    <% end %>
    <% if due_date %>
      <span class="flex items-center text-xs text-zinc-500 dark:text-zinc-400">
        <svg class="w-3.5 h-3.5 me-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
        Due <%= due_date %>
      </span>
    <% end %>
  </div>
</div>
