<%
  title ||= nil
  subtitle ||= nil
  features ||= []
  columns ||= 3
  variant ||= :grid
  html_options ||= {}
  content ||= nil

  variant = variant.to_sym

  col_class = case columns
  when 2 then "lg:grid-cols-2"
  when 4 then "lg:grid-cols-4"
  else "lg:grid-cols-3"
  end

  color_map = {
    primary: { bg: "bg-primary-100 dark:bg-primary-900", text: "text-primary-600 dark:text-primary-300" },
    green:   { bg: "bg-green-100 dark:bg-green-900", text: "text-green-600 dark:text-green-300" },
    purple:  { bg: "bg-purple-100 dark:bg-purple-900", text: "text-purple-600 dark:text-purple-300" },
    orange:  { bg: "bg-orange-100 dark:bg-orange-900", text: "text-orange-600 dark:text-orange-300" },
    red:     { bg: "bg-red-100 dark:bg-red-900", text: "text-red-600 dark:text-red-300" },
    teal:    { bg: "bg-teal-100 dark:bg-teal-900", text: "text-teal-600 dark:text-teal-300" }
  }

  classes = ["bg-white dark:bg-zinc-900", html_options.delete(:class)].compact_blank.join(" ")
%>

<section class="<%= classes %>" <%= tag.attributes(html_options) %>>
  <div class="py-8 px-4 mx-auto max-w-screen-xl lg:py-16">
    <% if title || subtitle %>
      <div class="max-w-screen-md mx-auto mb-8 text-center lg:mb-16">
        <% if title %>
          <h2 class="mb-4 text-3xl font-extrabold tracking-tight text-zinc-900 dark:text-white md:text-4xl"><%= title %></h2>
        <% end %>
        <% if subtitle %>
          <p class="text-zinc-500 dark:text-zinc-400 sm:text-xl"><%= subtitle %></p>
        <% end %>
      </div>
    <% end %>

    <% if variant == :grid || variant == :icons_only %>
      <div class="grid gap-8 md:grid-cols-2 <%= col_class %>">
        <% features.each do |feature| %>
          <% color = color_map[(feature[:color] || :primary).to_sym] || color_map[:primary] %>
          <div class="<%= variant == :icons_only ? 'text-center' : '' %>">
            <% if feature[:icon] %>
              <div class="<%= variant == :icons_only ? 'mx-auto' : '' %> flex items-center justify-center w-10 h-10 mb-4 rounded-lg <%= color[:bg] %>">
                <%= eden_icon(feature[:icon], size: :md, class: color[:text]) %>
              </div>
            <% end %>
            <h3 class="mb-2 text-xl font-bold text-zinc-900 dark:text-white"><%= feature[:title] %></h3>
            <% if feature[:description] %>
              <p class="text-zinc-500 dark:text-zinc-400"><%= feature[:description] %></p>
            <% end %>
          </div>
        <% end %>
      </div>
    <% elsif variant == :list %>
      <div class="space-y-12">
        <% features.each_with_index do |feature, i| %>
          <div class="flex flex-col gap-8 items-center <%= i.even? ? 'md:flex-row' : 'md:flex-row-reverse' %>">
            <% if feature[:image] %>
              <div class="md:w-1/2">
                <img src="<%= feature[:image] %>" alt="<%= feature[:title] %>" class="rounded-lg shadow-lg">
              </div>
            <% end %>
            <div class="<%= feature[:image] ? 'md:w-1/2' : 'w-full' %>">
              <% color = color_map[(feature[:color] || :primary).to_sym] || color_map[:primary] %>
              <% if feature[:icon] %>
                <div class="flex items-center justify-center w-10 h-10 mb-4 rounded-lg <%= color[:bg] %>">
                  <%= eden_icon(feature[:icon], size: :md, class: color[:text]) %>
                </div>
              <% end %>
              <h3 class="mb-2 text-2xl font-bold text-zinc-900 dark:text-white"><%= feature[:title] %></h3>
              <% if feature[:description] %>
                <p class="text-zinc-500 dark:text-zinc-400"><%= feature[:description] %></p>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>

    <%= content %>
  </div>
</section>
