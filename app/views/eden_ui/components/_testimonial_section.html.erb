<%
  title ||= "Testimonials"
  subtitle ||= nil
  testimonials ||= []
  variant ||= :grid
  html_options ||= {}
  content ||= nil

  variant = variant.to_sym

  classes = ["bg-zinc-50 dark:bg-zinc-800", html_options.delete(:class)].compact_blank.join(" ")
%>

<section class="<%= classes %>" <%= tag.attributes(html_options) %>>
  <div class="py-8 px-4 mx-auto max-w-screen-xl lg:py-16">
    <div class="mx-auto max-w-screen-md text-center mb-8 lg:mb-16">
      <% if title %>
        <h2 class="mb-4 text-3xl font-extrabold tracking-tight text-zinc-900 dark:text-white md:text-4xl"><%= title %></h2>
      <% end %>
      <% if subtitle %>
        <p class="font-light text-zinc-500 dark:text-zinc-400 sm:text-xl"><%= subtitle %></p>
      <% end %>
    </div>

    <% if variant == :grid %>
      <div class="grid gap-8 md:grid-cols-2">
        <% testimonials.each do |testimonial| %>
          <div class="p-6 bg-white rounded-lg shadow dark:bg-zinc-900">
            <svg class="w-8 h-8 mb-4 text-zinc-300 dark:text-zinc-600" fill="currentColor" viewBox="0 0 24 24"><path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z"/></svg>
            <p class="mb-4 text-lg text-zinc-500 dark:text-zinc-400 italic">"<%= testimonial[:quote] %>"</p>
            <% if testimonial[:rating] %>
              <div class="mb-4">
                <%= eden_rating(value: testimonial[:rating], size: :sm) %>
              </div>
            <% end %>
            <div class="flex items-center">
              <% if testimonial[:avatar_src] || testimonial[:avatar_initials] %>
                <div class="me-3">
                  <%= eden_avatar(
                    src: testimonial[:avatar_src],
                    initials: testimonial[:avatar_initials],
                    alt: testimonial[:author] || "",
                    size: :sm,
                    rounded: true
                  ) %>
                </div>
              <% end %>
              <div>
                <p class="text-sm font-semibold text-zinc-900 dark:text-white"><%= testimonial[:author] %></p>
                <% if testimonial[:role] || testimonial[:company] %>
                  <p class="text-sm text-zinc-500 dark:text-zinc-400">
                    <%= [testimonial[:role], testimonial[:company]].compact.join(", ") %>
                  </p>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
      </div>

    <% elsif variant == :featured && testimonials.any? %>
      <div class="grid gap-8 lg:grid-cols-3">
        <div class="lg:col-span-2 p-8 bg-white rounded-lg shadow dark:bg-zinc-900">
          <% featured = testimonials.first %>
          <svg class="w-10 h-10 mb-4 text-zinc-300 dark:text-zinc-600" fill="currentColor" viewBox="0 0 24 24"><path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z"/></svg>
          <p class="mb-6 text-xl text-zinc-500 dark:text-zinc-400 italic lg:text-2xl">"<%= featured[:quote] %>"</p>
          <% if featured[:rating] %>
            <div class="mb-4"><%= eden_rating(value: featured[:rating]) %></div>
          <% end %>
          <div class="flex items-center">
            <% if featured[:avatar_src] || featured[:avatar_initials] %>
              <div class="me-4">
                <%= eden_avatar(src: featured[:avatar_src], initials: featured[:avatar_initials], alt: featured[:author] || "", size: :lg, rounded: true) %>
              </div>
            <% end %>
            <div>
              <p class="font-semibold text-zinc-900 dark:text-white"><%= featured[:author] %></p>
              <% if featured[:role] || featured[:company] %>
                <p class="text-sm text-zinc-500 dark:text-zinc-400"><%= [featured[:role], featured[:company]].compact.join(", ") %></p>
              <% end %>
            </div>
          </div>
        </div>
        <div class="space-y-8">
          <% testimonials.drop(1).each do |testimonial| %>
            <div class="p-6 bg-white rounded-lg shadow dark:bg-zinc-900">
              <p class="mb-4 text-zinc-500 dark:text-zinc-400 italic">"<%= testimonial[:quote] %>"</p>
              <div class="flex items-center">
                <% if testimonial[:avatar_src] || testimonial[:avatar_initials] %>
                  <div class="me-3">
                    <%= eden_avatar(src: testimonial[:avatar_src], initials: testimonial[:avatar_initials], alt: testimonial[:author] || "", size: :sm, rounded: true) %>
                  </div>
                <% end %>
                <div>
                  <p class="text-sm font-semibold text-zinc-900 dark:text-white"><%= testimonial[:author] %></p>
                  <% if testimonial[:role] || testimonial[:company] %>
                    <p class="text-xs text-zinc-500 dark:text-zinc-400"><%= [testimonial[:role], testimonial[:company]].compact.join(", ") %></p>
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>

    <% elsif variant == :carousel && testimonials.any? %>
      <div class="max-w-screen-md mx-auto text-center" data-controller="carousel" data-carousel-index-value="0">
        <% testimonials.each_with_index do |testimonial, i| %>
          <div class="<%= i == 0 ? '' : 'hidden' %>" data-carousel-target="slide">
            <svg class="w-10 h-10 mx-auto mb-4 text-zinc-300 dark:text-zinc-600" fill="currentColor" viewBox="0 0 24 24"><path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z"/></svg>
            <p class="mb-6 text-xl text-zinc-500 dark:text-zinc-400 italic lg:text-2xl">"<%= testimonial[:quote] %>"</p>
            <% if testimonial[:rating] %>
              <div class="flex justify-center mb-4"><%= eden_rating(value: testimonial[:rating]) %></div>
            <% end %>
            <div class="flex items-center justify-center">
              <% if testimonial[:avatar_src] || testimonial[:avatar_initials] %>
                <div class="me-3">
                  <%= eden_avatar(src: testimonial[:avatar_src], initials: testimonial[:avatar_initials], alt: testimonial[:author] || "", size: :md, rounded: true) %>
                </div>
              <% end %>
              <div class="text-left">
                <p class="font-semibold text-zinc-900 dark:text-white"><%= testimonial[:author] %></p>
                <% if testimonial[:role] || testimonial[:company] %>
                  <p class="text-sm text-zinc-500 dark:text-zinc-400"><%= [testimonial[:role], testimonial[:company]].compact.join(", ") %></p>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>

    <%= content %>
  </div>
</section>
