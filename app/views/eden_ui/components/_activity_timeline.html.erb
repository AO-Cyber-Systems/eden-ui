<%
  items ||= []
  html_options ||= {}
  content ||= nil

  classes = [
    html_options.delete(:class)
  ].compact_blank.join(" ")

  color_classes = {
    "blue"   => "bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-300",
    "green"  => "bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",
    "red"    => "bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",
    "yellow" => "bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",
    "purple" => "bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",
    "gray"   => "bg-zinc-100 text-zinc-800 dark:bg-zinc-700 dark:text-zinc-300"
  }

  ring_classes = {
    "blue"   => "ring-primary-100 dark:ring-primary-900",
    "green"  => "ring-green-100 dark:ring-green-900",
    "red"    => "ring-red-100 dark:ring-red-900",
    "yellow" => "ring-yellow-100 dark:ring-yellow-900",
    "purple" => "ring-purple-100 dark:ring-purple-900",
    "gray"   => "ring-zinc-100 dark:ring-zinc-700"
  }
%>

<% if items.any? %>
  <ol class="relative border-s border-zinc-200 dark:border-zinc-700 <%= classes %>" <%= tag.attributes(html_options) %>>
    <% items.each do |item| %>
      <%
        color = item[:color] || "blue"
        dot_color = color_classes[color] || color_classes["blue"]
        dot_ring = ring_classes[color] || ring_classes["blue"]
      %>
      <li class="mb-10 ms-6">
        <span class="absolute -start-3 flex h-6 w-6 items-center justify-center rounded-full ring-8 ring-white dark:ring-zinc-900 <%= dot_color %>">
          <% if item[:avatar] %>
            <img class="rounded-full shadow-lg w-6 h-6" src="<%= item[:avatar] %>" alt="<%= item[:name] %>">
          <% elsif item[:icon] %>
            <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><%= item[:icon].html_safe %></svg>
          <% else %>
            <svg class="w-2.5 h-2.5" fill="currentColor" viewBox="0 0 20 20"><circle cx="10" cy="10" r="5"/></svg>
          <% end %>
        </span>
        <div class="items-center justify-between p-4 bg-white border border-zinc-200 rounded-lg shadow-sm sm:flex dark:bg-zinc-700 dark:border-zinc-600">
          <div class="text-sm font-normal text-zinc-500 dark:text-zinc-300">
            <% if item[:name] %>
              <span class="font-semibold text-zinc-900 dark:text-white"><%= item[:name] %></span>
            <% end %>
            <% if item[:action] %>
              <span><%= item[:action] %></span>
            <% end %>
            <% if item[:target] %>
              <a href="#" class="font-semibold text-primary-600 hover:underline dark:text-primary-500"><%= item[:target] %></a>
            <% end %>
          </div>
          <% if item[:time] %>
            <div class="mt-1 text-xs font-normal text-zinc-400 sm:mt-0 sm:ms-4 whitespace-nowrap">
              <%= item[:time] %>
            </div>
          <% end %>
        </div>
      </li>
    <% end %>
  </ol>
<% else %>
  <%= content %>
<% end %>
